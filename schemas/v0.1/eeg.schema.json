{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://psycho-validator.org/schemas/eeg/v1.0.0",
  "version": "1.0.0",
  "title": "EEG Stimulus/Recording Metadata",
  "description": "Schema for EEG recording metadata with technical and study parameters",
  "type": "object",
  "properties": {
    "Technical": {
      "type": "object",
      "description": "Technical EEG recording properties",
      "properties": {
        "StimulusType": {
          "type": "string",
          "enum": ["EEG"],
          "description": "Must be 'EEG' for EEG recordings"
        },
        "FileFormat": {
          "type": "string",
          "enum": ["edf", "bdf", "set", "vhdr", "fif", "mat"],
          "description": "EEG data file format"
        },
        "SamplingRate": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10000,
          "description": "Sampling rate in Hz"
        },
        "ChannelCount": {
          "type": "integer",
          "minimum": 1,
          "maximum": 512,
          "description": "Number of EEG channels recorded"
        },
        "ChannelLayout": {
          "type": "string",
          "enum": ["10-20", "10-10", "10-5", "custom"],
          "description": "Electrode placement system"
        },
        "ReferenceType": {
          "type": "string",
          "enum": ["common_average", "linked_mastoids", "Cz", "FCz", "custom"],
          "description": "Reference electrode configuration"
        },
        "GroundElectrode": {
          "type": "string",
          "description": "Ground electrode position (e.g., AFz, FPz)"
        },
        "ImpedanceThreshold": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Maximum allowed impedance in kOhm"
        },
        "FilterSettings": {
          "type": "object",
          "description": "Hardware filter settings",
          "properties": {
            "HighPass": {
              "type": "number",
              "minimum": 0,
              "description": "High-pass filter cutoff in Hz"
            },
            "LowPass": {
              "type": "number",
              "minimum": 0,
              "description": "Low-pass filter cutoff in Hz"
            },
            "NotchFilter": {
              "type": "number",
              "enum": [50, 60, null],
              "description": "Notch filter frequency (50/60 Hz or null)"
            }
          }
        },
        "AmplifierGain": {
          "type": "integer",
          "minimum": 1,
          "description": "Amplifier gain setting"
        }
      },
      "required": ["StimulusType", "FileFormat", "SamplingRate", "ChannelCount", "ChannelLayout", "ReferenceType"]
    },
    "Study": {
      "type": "object",
      "description": "Study-specific EEG parameters",
      "properties": {
        "Task": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9]+$",
          "description": "Task identifier (alphanumeric, no spaces)"
        },
        "Subject": {
          "type": "string",
          "pattern": "^sub-[0-9]+$",
          "description": "Subject identifier in BIDS format (e.g., sub-001)"
        },
        "Session": {
          "type": "string",
          "pattern": "^ses-[a-zA-Z0-9]+$",
          "description": "Session identifier in BIDS format (e.g., ses-001)"
        },
        "Run": {
          "type": "string",
          "pattern": "^run-[0-9]+$",
          "description": "Run identifier in BIDS format (e.g., run-01)"
        },
        "Paradigm": {
          "type": "string",
          "enum": ["oddball", "n_back", "stroop", "p300", "mmn", "erp", "rest", "sleep", "custom"],
          "description": "Experimental paradigm used"
        },
        "TriggerCodes": {
          "type": "object",
          "description": "Trigger/marker codes used in the experiment",
          "patternProperties": {
            "^[0-9]+$": {
              "type": "string",
              "description": "Trigger code description"
            }
          }
        },
        "BaselinePeriod": {
          "type": "array",
          "items": {
            "type": "number"
          },
          "minItems": 2,
          "maxItems": 2,
          "description": "Baseline period in ms [start, end]"
        },
        "EpochLength": {
          "type": "number",
          "minimum": 0,
          "description": "Epoch length in seconds for event-related analysis"
        },
        "TrialCount": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of trials/epochs in the recording"
        }
      },
      "required": ["Task", "Subject", "Run", "Paradigm"]
    },
    "Categories": {
      "type": "object",
      "description": "EEG analysis and categorization",
      "properties": {
        "AnalysisType": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["erp", "time_frequency", "connectivity", "source_localization", "microstate", "complexity"]
          },
          "description": "Types of analysis performed on the data"
        },
        "ERPComponents": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["P1", "N1", "P2", "N2", "P3", "N400", "P600", "MMN", "CNV", "LRP"]
          },
          "description": "ERP components of interest"
        },
        "FrequencyBands": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["delta", "theta", "alpha", "beta", "gamma", "high_gamma"]
          },
          "description": "Frequency bands analyzed"
        },
        "CognitiveProcesses": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["attention", "memory", "language", "executive", "motor", "sensory", "emotion"]
          },
          "description": "Cognitive processes investigated"
        },
        "DataQuality": {
          "type": "string",
          "enum": ["excellent", "good", "acceptable", "poor"],
          "description": "Overall data quality assessment"
        },
        "ArtifactTypes": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["eye_blink", "eye_movement", "muscle", "cardiac", "line_noise", "electrode"]
          },
          "description": "Types of artifacts present in the data"
        }
      }
    },
    "Metadata": {
      "type": "object",
      "description": "Additional metadata and administrative information",
      "properties": {
        "SchemaVersion": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "description": "Version of the schema used (semantic versioning)"
        },
        "CreationDate": {
          "type": "string",
          "format": "date",
          "description": "Date when the metadata was created (YYYY-MM-DD)"
        },
        "Creator": {
          "type": "string",
          "description": "Person or system that created this metadata"
        },
        "Institution": {
          "type": "string",
          "description": "Institution where the data was collected"
        },
        "Equipment": {
          "type": "object",
          "description": "EEG recording equipment details",
          "properties": {
            "Manufacturer": {
              "type": "string",
              "enum": ["BrainProducts", "Neuroscan", "ANT", "Biosemi", "EGI", "g.tec", "Other"],
              "description": "EEG system manufacturer"
            },
            "Model": {
              "type": "string",
              "description": "EEG amplifier model"
            },
            "SerialNumber": {
              "type": "string",
              "description": "Device serial number"
            },
            "SoftwareVersion": {
              "type": "string",
              "description": "Recording software version"
            }
          }
        },
        "ExperimentalNotes": {
          "type": "string",
          "description": "Free-text notes about the recording session"
        },
        "ProcessingHistory": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "History of processing steps applied to the data"
        }
      },
      "required": ["SchemaVersion", "CreationDate"]
    }
  },
  "required": ["Technical", "Study", "Metadata"]
}
