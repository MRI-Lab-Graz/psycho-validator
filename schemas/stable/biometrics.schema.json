{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://psycho-validator.org/schemas/biometrics/v1.0.0",
  "version": "1.0.0",
  "title": "Biometrics Metadata",
  "description": "Schema for biometric and physiological assessment data (e.g., VO2max, planks, balance)",
  "type": "object",
  "properties": {
    "Technical": {
      "type": "object",
      "description": "Technical biometric properties",
      "properties": {
        "StimulusType": {
          "type": "string",
          "enum": ["Biometrics"],
          "description": "Must be 'Biometrics' for biometric data"
        },
        "FileFormat": {
          "type": "string",
          "enum": ["tsv"],
          "description": "Data file format"
        },
        "Equipment": {
          "type": "string",
          "description": "Equipment used for measurement (e.g., Stopwatch, Cycle Ergometer, Balance Board)"
        },
        "Supervisor": {
          "type": "string",
          "enum": ["investigator", "physician", "trainer", "self"],
          "description": "Who supervised the assessment"
        }
      },
      "required": ["StimulusType", "FileFormat", "Equipment"]
    },
    "Study": {
      "type": "object",
      "description": "Study-specific assessment parameters",
      "properties": {
        "BiometricName": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9]+$",
          "description": "Short biometric identifier (e.g., vo2max, planks)"
        },
        "OriginalName": {
          "type": "string",
          "description": "Full name of the test (e.g., UKK Walk Test, Plank Test)"
        },
        "Protocol": {
          "type": "string",
          "description": "Reference to the protocol used"
        },
        "Description": {
          "type": "string",
          "description": "Detailed description of the test procedure"
        },
        "Instructions": {
          "type": "string",
          "description": "Instructions given to the participant"
        },
        "Author": {
          "type": "string",
          "description": "Author(s) of the test protocol"
        },
        "DOI": {
          "type": "string",
          "description": "DOI of the reference publication"
        },
        "Reference": {
          "type": "string",
          "description": "Citation or reference for the test protocol"
        },
        "EstimatedDuration": {
          "type": "string",
          "description": "Estimated time to complete the assessment (e.g., '15 minutes')"
        },
        "TargetPopulation": {
          "type": "string",
          "description": "Intended population for the test (e.g., 'Adults 18-65', 'Children')"
        },
        "ExclusionCriteria": {
          "type": "string",
          "description": "Conditions under which the test should not be performed"
        }
      },
      "required": ["BiometricName", "OriginalName", "Description"]
    },
    "Metadata": {
      "type": "object",
      "description": "Administrative metadata",
      "properties": {
        "SchemaVersion": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$"
        },
        "CreationDate": {
          "type": "string",
          "format": "date"
        },
        "Creator": {
          "type": "string"
        }
      },
      "required": ["SchemaVersion", "CreationDate"]
    }
  },
  "required": ["Technical", "Study", "Metadata"],
  "additionalProperties": {
    "type": "object",
    "properties": {
      "Description": {
        "type": "string",
        "description": "Description of the metric"
      },
      "Units": {
        "type": "string",
        "description": "Unit of measurement (e.g., kg, sec, ml/kg/min)"
      },
      "MinValue": {
        "type": "number",
        "description": "Minimum allowed value for this column"
      },
      "MaxValue": {
        "type": "number",
        "description": "Maximum allowed value for this column"
      },
      "WarnMinValue": {
        "type": "number",
        "description": "Minimum value threshold for warning"
      },
      "WarnMaxValue": {
        "type": "number",
        "description": "Maximum value threshold for warning"
      },
      "AllowedValues": {
        "type": "array",
        "items": {
          "type": ["string", "number"]
        },
        "description": "List of allowed values for this column"
      },
      "DataType": {
        "type": "string",
        "enum": ["string", "integer", "float"],
        "description": "Expected data type for this column"
      }
    },
    "required": ["Description", "Units"]
  }
}
