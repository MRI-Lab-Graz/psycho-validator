{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://psycho-validator.org/schemas/survey/v1.0.0",
  "version": "1.0.0",
  "title": "Survey Data Metadata",
  "description": "Schema for questionnaire and survey data",
  "type": "object",
  "properties": {
    "Technical": {
      "type": "object",
      "description": "Technical survey properties",
      "properties": {
        "StimulusType": {
          "type": "string",
          "enum": ["Questionnaire"],
          "description": "Must be 'Questionnaire' for survey data"
        },
        "FileFormat": {
          "type": "string",
          "enum": ["tsv"],
          "description": "Survey data file format"
        },
        "SoftwarePlatform": {
          "type": "string",
          "description": "Software platform used for data collection (e.g., LimeSurvey, RedCap)"
        },
        "Language": {
          "type": "string",
          "pattern": "^[a-z]{2}(-[A-Z]{2})?$",
          "description": "Language of the questionnaire (e.g., en, en-US, de-AT)"
        },
        "Respondent": {
          "type": "string",
          "enum": ["self", "clinician", "parent", "teacher", "other"],
          "description": "Who provided the responses"
        }
      },
      "required": ["StimulusType", "FileFormat", "SoftwarePlatform", "Language", "Respondent"]
    },
    "Study": {
      "type": "object",
      "description": "Study-specific survey parameters",
      "properties": {
        "TaskName": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9]+$",
          "description": "Short task identifier (e.g., bdi, ads)"
        },
        "OriginalName": {
          "type": "string",
          "description": "Full canonical name of the instrument (e.g., Beck Depression Inventory)"
        },
        "Version": {
          "type": "string",
          "description": "Version of the instrument (e.g., II, 5.0)"
        },
        "Citation": {
          "type": "string",
          "description": "DOI or citation for the instrument"
        }
      },
      "required": ["TaskName", "OriginalName"]
    },
    "Metadata": {
      "type": "object",
      "description": "Administrative metadata",
      "properties": {
        "SchemaVersion": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$"
        },
        "CreationDate": {
          "type": "string",
          "format": "date"
        },
        "Creator": {
          "type": "string"
        }
      },
      "required": ["SchemaVersion", "CreationDate"]
    }
  },
  "required": ["Technical", "Study", "Metadata"],
  "additionalProperties": {
    "type": "object",
    "properties": {
      "Description": {
        "type": "string",
        "description": "The exact question text presented to the participant"
      },
      "Levels": {
        "type": "object",
        "description": "Mapping of numeric values to text labels",
        "patternProperties": {
          "^.*$": { "type": "string" }
        }
      },
      "Units": {
        "type": "string",
        "description": "Unit of measurement (if applicable)"
      },
      "TermURL": {
        "type": "string",
        "format": "uri",
        "description": "URL to a definition of the term"
      },
      "Relevance": {
        "type": "string",
        "description": "Logic/Relevance equation for this item (e.g., Q01 == 1)"
      }
    },
    "required": ["Description"]
  }
}
